setwd("C:/Users/Manfred/Desktop/tdde01/ml-lab-tdde01/lab2")
communities = read.csv("communities.csv", header = TRUE)
install.packages(caret)
install.packages("caret")
scaler = preProcess(communities - ViolentCrimesPerPop)
library(caret)
scaler = preProcess(communities - ViolentCrimesPerPop)
scaler = preProcess(communities - ViolentCrimesPerPop)
column_name <- "ViolentCrimesPerPop"
index_number <- match(column_name, names(comunities))
index_number <- match(column_name, names(communities))
index_number
names(communities)
scaler = preProcess(communities - 101)
View(scaler)
# names(communities) gives ViolentCrimesPerPop index 101
scaler = preProcess(communities[,-101], method = c("center", "scale"))
communities = read.csv("communities.csv", header = TRUE)
library(caret)
scaler = preProcess(communities[,-101], method = c("center", "scale"))
communities_scaled <- predict(scaler, communities[,-101])
cov(communities_scaled)
pca_results <- eigen(cov_matrix)
pca_results <- eigen(cov)
cov <- cov(communities_scaled)
pca_results <- eigen(cov)
pca_results
pca_results$values
eigen_values <- pca_results$values
sum(eigen_values)
total_variance <- sum(eigen_values)
total_variance
cumulative_variance <- cumsum(variance_explained)
cumulative_variance <- cumsum(eigen_values/total_variance)
components_for_95_percent <- which(cumulative_variance >= 0.95)[1]
components_for_95_percent
variance_proportion <- eigen_values/total_variance
varaince_proportion <- variance_proportion[1]
variance_proportion <- eigen_values/total_variance
variance_proportion[1]
variance_proportion[0]
variance_proportion[2]
pca_results_2 = princomp(communities_scaled)
pca_results_2 = princomp(communities_scaled)
pca_results_2$loadings
plot(pca_results_2$loadings[], main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
loading_scores_sorted <- sort(pca_results_2$loadings, decreasing=TRUE)
plot(loading_scores_sorted, main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
plot(pca_results_2$loadings, main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
plot(abs(pca_results_2$loadings), main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
plot(pca_results_2$loadings, main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
install.packages("ggplot2")
plot(pca_results_2$loadings[,1], main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
sorted_pc1_loadings <- sort(pc1_loadings)
sorted_pc1_loadings <- sort(pca_results_2$loadings)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features (Original Variables)",
ylab = "PC1 Loading Score",
# Customizations for readability:
las = 2,       # Rotate x-axis labels vertically
cex.names = 0.5)
colnames(pca_results_2$loadings)[which.max(res2)]
plot(pca_results_2$loadings[,1], main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
sorted_pc1_loadings <- sort(pca_results_2$loadings[,1])
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features (Original Variables)",
ylab = "PC1 Loading Score",
# Customizations for readability:
las = 2,       # Rotate x-axis labels vertically
cex.names = 0.5)
#Trace plot of loading scores
pca_results_2 = princomp(communities_scaled)
loading_scores_sorted <- sort(pca_results_2$loadings, decreasing=TRUE)
plot(pca_results_2$loadings[,1], main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
#No not many varibles have a notable contribution to
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]))
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "PC1 Loading Score",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = TRUE)
barplot(sorted_pc1_loadings,
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "PC1 Loading Score",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = FALSE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "PC1 Loading Score",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
#Trace plot of loading scores
pca_results_2 = princomp(communities_scaled)
loading_scores_sorted <- sort(pca_results_2$loadings, decreasing=TRUE)
plot(pca_results_2$loadings[,1], main="Trace Plot of PC1 Loading scores", ylab="Loading Score")
#No not many varibles have a notable contribution to
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = FALSE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.1)
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = FALSE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.1)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 1)
ngs,
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.7)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = TRUE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = FALSE)
barplot(sorted_pc1_loadings,
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = FALSE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = TRUE)
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = TRUE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
colnames(pca_results_2$loadings)[which.max(res2)]
pc1_loadings <- pca_results_2$loadings[,1]
sorted_pc1_loadings <- sort(abs_pc1_loadings, decreasing=TRUE)
pc1_loadings <- pca_results_2$loadings[,1]
abs_pc1_loadings <- abs(pc1_loadings)
sorted_pc1_loadings <- sort(abs_pc1_loadings, decreasing=TRUE)
pc1_loadings <- pca_results_2$loadings[,1]
abs_pc1_loadings <- abs(pc1_loadings)
sorted_pc1_loadings <- sort(abs_pc1_loadings, decreasing=TRUE)
top_5_contributing_features = sorted_pc1_loadings[1:5]
colnames(top_5_contributing_features)
print(top_5_contributions)
top_5_contributing_features = sorted_pc1_loadings[1:5]
print(top_5_contributing_features)
print(top_5_contributing_features)
source("C:/Users/Manfred/Desktop/tdde01/ml-lab-tdde01/lab2/assingment3.R", echo = TRUE)
print(top_5_contributing_features)
#greatest contributing features are: medFamInc, medIncome PctKids2Par pctWInvInc, PctPopUnderPov
sorted_pc1_loadings <- pca_results_2$loadings[,1]
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "PC1 Loading Score",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
sorted_pc1_loadings <- sort(pca_results_2$loadings[,1], decreasing = TRUE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "PC1 Loading Score",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
target <- communities[, ncol(crime_data_clean)]
target <- communities[, ncol(communities)]
target
target <- communities[,101]
#extract the crimerate
crime_rate <- communities[,101]
scores_df <- data.frame(
PC1 = pca_results_2$scores[,1],
PC2 = pca_results_2$scores[,2],
crime_rate = crime_rate
)
ggplot(scores_df)
ggplot(scores_df, x=PC1, y=PC2)
ggplot(scores_df, x=PC1, y=PC2, color=crime_rate)
df, mapping = aes(x = group, y = value)) +
ggplot(scores_df, aes(x=PC1, y=PC2, color=crime_rate)  +
geom_point()
ggplot(scores_df, aes(x=PC1, y=PC2, color=crime_rate)  +
ggplot(scores_df, aes(x = PC1, y = PC2, color = Crime)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_gradient(low = "blue", high = "red") +
labs(
title = "PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop"
) +
theme_minimal()
ggplot(scores_df, aes(x = PC1, y = PC2, color = Crime)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_gradient(low = "blue", high = "red") +
labs(
title = "PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop"
) +
theme_minimal()
rlang::last_trace()
install.packages("crayon")
ggplot(scores_df, aes(x = PC1, y = PC2, color = Crime)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_gradient(low = "blue", high = "red") +
labs(
title = "PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop"
) +
theme_minimal()
ggplot(scores_df, aes(x = PC1, y = PC2, color = Crime)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_gradient(low = "blue", high = "red") +
labs(
title = "PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop"
) +
theme_minimal()
rlang::last_trace()
ggplot(scores_df, aes(x = PC1, y = PC2, color = crime_rate)) +
geom_point(alpha = 0.7, size = 3) +
scale_color_gradient(low = "blue", high = "red") +
labs(
title = "PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop"
) +
theme_minimal()
ggplot(scores_df, aes(x=PC1, y=PC2, color=crime_rate)  +
geom_point(alpha=0.7, size=3) +
scale_color_gradient(low="blue", high="red")+
labs(title="PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop"
) +
theme_minimal())
ggplot(scores_df, aes(x=PC1, y=PC2, color=crime_rate))  +
geom_point(alpha=0.7, size=3) +
scale_color_gradient(low="blue", high="red")+
labs(title="PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop"
) +
theme_minimal())
ggplot(scores_df, aes(x=PC1, y=PC2, color=crime_rate))  +
geom_point(alpha=0.7, size=3) +
scale_color_gradient(low="blue", high="red")+
labs(title="PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop") +
theme_minimal()
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
sorted_pc1_loadings <- sort(pca_results_2$loadings[,1], decreasing = TRUE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "PC1 Loading Score",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
sorted_pc1_loadings <- sort(abs(pca_results_2$loadings[,1]), decreasing = TRUE)
barplot(sorted_pc1_loadings,
main = "PC1 Feature Contributions (Loadings)",
xlab = "Features",
ylab = "|PC1 Loading Score|",
las = 2,       # rotates x-axis labels vertically
cex.names = 0.5)
ggplot(scores_df, aes(x=PC1, y=PC2, color=crime_rate))  +
geom_point(alpha=0.7, size=3) +
scale_color_gradient(low="blue", high="red")+
labs(title="PCA Scores Colored by Violent Crime Rate",
x = "Principal Component 1 (PC1)",
y = "Principal Component 2 (PC2)",
color = "Violent Crimes per Pop") +
theme_minimal()
